/**
 * vue-modal-router v0.4.0
 * (c) 2019 FlynnLee
 * @license MIT
 */
!function(o,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):o.vueModalRouter=t()}(this,function(){"use strict";var o={name:"ModalRouterView",functional:!0,render:function(o,t){var n=t.parent,e=n.$createElement,i=n.$root._modalComponents;return console.log("modalComponents",i),e("div",{},i.map(function(o){return e(o.component,{props:o.props,on:o.on,ModalComponent:o})}))}},t={install:function(o){o.directive("modal-link",{bind:function(o,t,n){o.__modalTo__=t.value;var e=t.arg||"click",i=t.modifiers;o.addEventListener(e,function(t){i.stop&&t.stopPropagation(),i.prevent&&t.preventDefault(),n.context.$modalRouter.push(o.__modalTo__)})},componentUpdated:function(o,t,n){o.__modalTo__=t.value}})}},n=(function(){function o(o){this.value=o}function t(t){function n(o,t){return new Promise(function(n,i){var u={key:o,arg:t,resolve:n,reject:i,next:null};a?a=a.next=u:(r=a=u,e(o,t))})}function e(n,r){try{var a=t[n](r),u=a.value;u instanceof o?Promise.resolve(u.value).then(function(o){e("next",o)},function(o){e("throw",o)}):i(a.done?"return":"normal",a.value)}catch(o){i("throw",o)}}function i(o,t){switch(o){case"return":r.resolve({value:t,done:!0});break;case"throw":r.reject(t);break;default:r.resolve({value:t,done:!1})}r=r.next,r?e(r.key,r.arg):a=null}var r,a;this._invoke=n,"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(o){return this._invoke("next",o)},t.prototype.throw=function(o){return this._invoke("throw",o)},t.prototype.return=function(o){return this._invoke("return",o)}}(),function(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}),e=function(){function o(o,t){for(var n=0;n<t.length;n++){var e=t[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}return function(t,n,e){return n&&o(t.prototype,n),e&&o(t,e),t}}(),i=function(o){return o.replace(/-([a-z])/g,function(o,t){return t.toUpperCase()}).replace(/^[a-z]/,function(o){return o.toUpperCase()})},r=function(){function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n(this,o),this._modals=t,this._root=e,this._modalComponents=[],this._init()}return e(o,[{key:"_init",value:function(){var o=this;Object.keys(this._modals).forEach(function(t){o._modals[t]._isModal=!0})}},{key:"get",value:function(o){var t=i(o);return this._root?this._modals[o]||this._modals[t]||this._root.get(o):this._modals[o]||this._modals[t]}},{key:"push",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=o.name,n=void 0===t?"":t,e=o.props,i=void 0===e?{}:e,r=o.on,a=void 0===r?{}:r,u=this.get(n);if(!u)throw new Error('[vue-modal-router].push can not find modal "'+n+'",register first');this._modalComponents.push({component:u,props:i,on:a})}},{key:"close",value:function(o){var t=o.$vnode.data.ModalComponent,n=this._modalComponents.findIndex(function(o){return o===t});this._modalComponents.splice(n,1)}}]),o}();return r.install=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.delay,a=void 0===i?200:i,u=e.model,s=void 0===u?"show":u;n.mixin({beforeCreate:function(){if(this.$root.$options.modalRouter){if(this.$options.modalRouter){var o=[];this.$modalRouter=this.$options.modalRouter,n.util.defineReactive(this,"_modalComponents",o)}else this.$options.modals?this.$modalRouter=new r(this.$options.modals||{},this.$root.$modalRouter):this.$modalRouter=this.$root.$modalRouter;this.$modalRouter._modalComponents=this.$root._modalComponents}},created:function(){var o=this;this.$options._isModal&&(this[s]=!0,this.$watch(s,function(t){t||setTimeout(function(){o.$modalRouter.close(o)},a)}))}}),n.component("modal-router-view",o),n.use(t)},r});
